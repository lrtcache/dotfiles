export EDITOR=$(which nvim)
export VISUAL=$(which nvim)

# make it harder to wipe out files
set -o noclobber

# default terminal to xterm-256color (mainly for ghostty to work with tmux remotely)
TERM=xterm-256color
stty sane

# car-go brr
export PATH="$HOME/.cargo/bin:$PATH"

# Lines configured by zsh-newuser-install
HISTFILE=~/.histfile
HISTSIZE=1000
SAVEHIST=500
# End of lines configured by zsh-newuser-install
#
# The following lines were added by compinstall
zstyle :compinstall filename "$HOME/.zshrc"

autoload -Uz compinit
compinit
# End of lines added by compinstall

# vi mode
bindkey -v

# alias for git
alias ga="git add"
alias gs="git status"
alias gS="git switch"
alias gb="git branch"
alias gc="git commit"
alias gd="git diff"
alias gl="git log"

autoload -Uz vcs_info
precmd() { vcs_info }

zstyle ':vcs_info:git:*' formats "%b "
setopt PROMPT_SUBST

function activate() {
    local dir=${1:-.venv}
    source $dir/bin/activate
}

NEWLINE=$'\n'
# PROMPT="%F{green}%*%f %F{blue}%~%f %F{red}${vcs_info_msg_0_}%f${NEWLINE}$ "
function setup_prompt() {
    local USERNAME_FMT="%F{blue}%n%f" # name
    local HOSTNAME_FMT="%F{magenta}@%m%f" # machine
    local CWD_FMT="%F{yellow}%~%f"
    PROMPT="${USERNAME_FMT}${HOSTNAME_FMT}: ${CWD_FMT} %F{red}${vcs_info_msg_0_}%f${NEWLINE}$ "
}

setup_prompt

ZSH_THEME='iosevka'

# expand aliases
function expand-alias() {
    zle _expand_alias
    zle self-insert
}

zle -N expand-alias

bindkey -M viins " " expand-alias

eval "$(zoxide init zsh)"

[ -f ~/.fzf.zsh ] && source ~/.fzf.zsh

# export env variables
[ -f "$HOME/.zshenv" ] && source "$HOME/.zshenv"

# BEGIN opam configuration
# This is useful if you're using opam as it adds:
#   - the correct directories to the PATH
#   - auto-completion for the opam binary
# This section can be safely removed at any time if needed.
[[ ! -r '/home/louis/.opam/opam-init/init.zsh' ]] || source '/home/louis/.opam/opam-init/init.zsh' > /dev/null 2> /dev/null
# END opam configuration

. "$HOME/.local/bin/env"
